# LCP Optimization Plan ‚Äî gaycarboys.com

**Date:** February 5, 2026
**Goal:** Reduce LCP from 3,245ms (CrUX p75) / 3,343ms (Lighthouse) to under 2,500ms
**Constraint:** No visual or functionality changes

---

## Current Lighthouse Results (Mobile Simulation)

| Metric | Value | Status |
|--------|-------|--------|
| **Performance Score** | 92/100 | ‚úÖ Good |
| **FCP** | 961ms | ‚úÖ Good |
| **LCP** | 3,343ms | ‚ö†Ô∏è Needs improvement (target: <2,500ms) |
| **TBT** | 0ms | ‚úÖ Excellent |
| **CLS** | 0.012 | ‚úÖ Good |
| **SI** | 961ms | ‚úÖ Good |
| **TTFB** | 15ms actual / 616ms simulated | ‚úÖ Good |

**What's working well:** Interactivity (TBT=0), visual stability (CLS=0.01), server response, FCP. The site is well-optimized overall ‚Äî LCP is the only remaining bottleneck.

---

## Root Cause Analysis

### LCP Breakdown (Simulated Mobile)
- **TTFB:** ~616ms (simulated 4G) ‚Äî unavoidable with throttling
- **LCP Load Delay:** ~1,100ms ‚Äî gap between HTML arrival and LCP image download starting
- **LCP Load Duration:** large image download over slow simulated connection

### The LCP Element
The LCP element is the **hero image** in the bento grid (BYD Shark photo, `BYD-Shark-6-5.webp`).

---

## Issues Found (Ranked by Impact)

### üî¥ Issue 1: Preload/Image srcset Mismatch ‚Üí Double Download

**The Problem:**
The `<link rel="preload">` in `<head>` has a **different srcset** than the actual `<img>` tag rendered by Jetpack/WP.com CDN.

**Preload srcset** (from `functions.php gcb_preload_lcp_image`):
```
300w, 200w, 400w, 600w, 768w, 800w, 1000w
imagesizes="(max-width: 768px) 100vw, 66vw"
```

**Actual `<img>` srcset** (generated by Jetpack CDN):
```
350w, 387w, 415w, 677w, 700w, 743w, 774w, 809w, 830w, 1005w, 1050w, 1104w, 1161w, 1196w, 1245w, 1486w, 1618w, 1998w, 2392w
sizes="(min-width: 1025px) 1196px, (min-width: 835px) 999px, ..., 335px"
```

**Result:** The browser preloads one image variant, then discovers the `<img>` needs a DIFFERENT variant, downloads it again. Lighthouse shows **two requests** for the same image totaling ~206KB.

**Estimated Impact:** -400-600ms (eliminating wasted preload + aligning download)

---

### üî¥ Issue 2: Hero Image Too Large for Mobile

**The Problem:**
On a mobile phone (375px viewport), the browser selects the `resize=415x220` variant (~20-30KB would be ideal). But:
- The preload's `imagesizes="(max-width: 768px) 100vw"` tells the browser to preload a much larger image
- The actual image source URL starts at `fit=1000x667` (the full-size)

On simulated mobile 4G, downloading even a 90KB image takes significant time.

**Estimated Impact:** -200-400ms if mobile gets a properly-sized ~30KB image

---

### üü° Issue 3: Font Preload URL Mismatch (404 + Wrong Domain)

**The Problem:**
Theme preloads from `fonts.gstatic.com/s/playfairdisplay/v37/...` but production actually loads from `fonts.wp.com/s/playfairdisplay/v36/...`:
- Different domain (gstatic vs wp.com) ‚Üí preload is wasted, requires two DNS lookups
- Different version (v37 vs v36) ‚Üí the preloaded font file is different from what's used
- The v37 URL returns **404** (19 bytes) ‚Üí wasted connection entirely

**Network cost:** Two font downloads from `fonts.wp.com` at ~67KB + 64KB = 131KB that aren't preloaded because the preload targets the wrong URLs.

**Estimated Impact:** -100-200ms

---

### üü° Issue 4: Unnecessary Open Sans Font Loading

**The Problem:**
Production loads Open Sans via `fonts-api.wp.com/css?family=Open+Sans` (2.8KB CSS + font files), but the design system only uses:
- Playfair Display (headings)
- Space Mono (nav/meta)
- System sans-serif (body)

Open Sans appears to be a leftover from Avada/previous theme.

**Estimated Impact:** -50-100ms (eliminates CSS request + potential font download)

---

### üü° Issue 5: wp-emoji Script Loading

**The Problem:**
`wp-emoji-release.min.js` (5.6KB) loads on every page to detect and replace emoji. For an automotive magazine, this is unnecessary overhead.

**Estimated Impact:** -20-50ms (small but adds to total)

---

### üü¢ Issue 6: Bloated HTML Document (159KB)

**The Problem:**
The HTML document is 159KB. Contributors:
- 24 inline `<style>` blocks
- Each image has 19-breakpoint srcsets (Jetpack CDN generates these)
- 10+ dns-prefetch tags for unused domains (gravatar x3, public-api, etc.)

**Estimated Impact:** -50-100ms (faster HTML parse on simulated mobile)

---

### üü¢ Issue 7: Unused CSS (~15KB)

**The Problem:**
Lighthouse flags ~15KB of unused CSS from `_jb_static/??ceb9e3360e` (Jetpack bundle). Already being defer-loaded via media swap, but the bytes still transfer.

**Estimated Impact:** Minimal (already deferred)

---

## Optimization Plan

### Phase 1: Fix LCP Image (Target: -600-800ms) üéØ

#### 1a. Align preload with Jetpack CDN srcset
The preload needs to match what Jetpack CDN actually renders. Two approaches:

**Option A (Recommended): Remove custom preload, rely on fetchpriority="high"**
Since Jetpack/WP.com rewrites the srcset anyway, our custom preload with WordPress-native srcset will always mismatch. Instead:
- Remove `gcb_preload_lcp_image()` from functions.php
- Ensure the hero `<img>` has `fetchpriority="high"` and `loading="eager"` (already does)
- The browser will prioritize the image based on fetchpriority without a mismatched preload causing double download

**Option B: Generate preload from Jetpack CDN URLs**
- Hook later in the render pipeline to capture the Jetpack-rewritten srcset
- Output the preload with the exact same srcset/sizes as the rendered image
- More complex, fragile if Jetpack changes behavior

#### 1b. Optimize hero image sizes attribute
The bento grid's hero image `sizes` attribute should ensure mobile gets a small variant:
```
sizes="(max-width: 480px) 100vw, (max-width: 768px) 50vw, 33vw"
```
This tells the browser on a 375px phone to pick the ~375px variant (~30KB) instead of larger ones.

---

### Phase 2: Fix Font Loading (Target: -200-300ms)

#### 2a. Fix or remove font preloads
Either:
- Update preload URLs to match `fonts.wp.com` URLs that actually load in production
- Or remove font preloads entirely if WP.com font proxy handles it

#### 2b. Remove Open Sans
Add to `functions.php`:
```php
function gcb_remove_open_sans() {
    wp_deregister_style('wp-block-library-theme');
    // Or dequeue the specific Open Sans stylesheet
}
```
Or add a filter to remove the fonts-api.wp.com Open Sans request.

---

### Phase 3: Remove Unnecessary Resources (Target: -100-200ms)

#### 3a. Disable wp-emoji
```php
function gcb_disable_emojis() {
    remove_action('wp_head', 'print_emoji_detection_script', 7);
    remove_action('wp_print_styles', 'print_emoji_styles');
    remove_filter('the_content_feed', 'wp_staticize_emoji');
    remove_filter('comment_text_rss', 'wp_staticize_emoji');
    remove_filter('wp_mail', 'wp_staticize_emoji_for_email');
}
add_action('init', 'gcb_disable_emojis');
```

#### 3b. Clean up unnecessary dns-prefetch
Remove prefetch hints for domains not used on homepage (gravatar, public-api, etc.).

---

## Expected Results

| Change | Estimated LCP Reduction |
|--------|------------------------|
| Fix preload mismatch (stop double download) | -400-600ms |
| Proper mobile image sizing | -100-200ms |
| Fix font preloads | -100-200ms |
| Remove Open Sans | -50-100ms |
| Remove wp-emoji | -20-50ms |
| **Total estimated** | **-670-1,150ms** |

**Projected LCP:** 3,343ms - ~850ms = **~2,500ms** (borderline good)

---

## Implementation Order

1. **Fix preload mismatch** ‚Äî highest impact, lowest risk
2. **Remove wp-emoji** ‚Äî easy win, no visual impact
3. **Fix font preload URLs** ‚Äî moderate impact
4. **Remove Open Sans** ‚Äî needs verification it's truly unused
5. **Clean up dns-prefetch** ‚Äî small wins

---

## Testing Strategy

After each change:
1. Run Lighthouse locally: `CHROME_PATH="..." lighthouse https://gaycarboys.com/ --only-categories=performance --form-factor=mobile`
2. Visual check: no layout shifts or missing styles
3. Deploy to staging and re-run Lighthouse
4. Monitor CrUX data after production deploy (28-day rolling window)

---

## Important Notes

- CrUX data is a 28-day rolling average ‚Äî improvements won't show immediately
- Simulated Lighthouse results can vary ¬±500ms between runs
- The WP.com CDN/Jetpack Boost layer adds complexity ‚Äî changes to srcset/preload behavior may be partially controlled by Jetpack
- Some optimizations (dns-prefetch cleanup) may need to be done at WP.com hosting level or via mu-plugins
