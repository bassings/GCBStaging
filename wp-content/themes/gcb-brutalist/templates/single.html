<!-- wp:template-part {"slug":"header","tagName":"header"} /-->

<!-- wp:group {"tagName":"main","style":{"spacing":{"margin":{"top":"var:preset|spacing|50"},"padding":{"right":"var:preset|spacing|30","left":"var:preset|spacing|30"}}},"layout":{"type":"constrained"}} -->
<main id="main-content" class="wp-block-group" style="margin-top:var(--wp--preset--spacing--50);padding-right:var(--wp--preset--spacing--30);padding-left:var(--wp--preset--spacing--30)">

	<!-- wp:group {"style":{"spacing":{"padding":{"top":"3rem","right":"3rem","bottom":"3rem","left":"3rem"}},"border":{"width":"2px","style":"solid","color":"var:preset|color|brutal-border"}}} -->
	<div class="wp-block-group" style="border-color:var(--wp--preset--color--brutal-border);border-style:solid;border-width:2px;padding-top:3rem;padding-right:3rem;padding-bottom:3rem;padding-left:3rem">

		<!-- wp:post-title {"level":1,"style":{"typography":{"fontFamily":"var(--wp--preset--font-family--playfair)","fontSize":"3rem","lineHeight":"1.2"},"spacing":{"margin":{"bottom":"var:preset|spacing|30"}}}} /-->

		<!-- wp:post-date {"style":{"typography":{"fontFamily":"var(--wp--preset--font-family--mono)","fontSize":"0.875rem"},"color":{"text":"var:preset|color|brutal-border"}},"className":"gcb-post-meta"} /-->

		<!-- wp:separator {"style":{"spacing":{"margin":{"top":"var:preset|spacing|30","bottom":"var:preset|spacing|30"}},"color":{"background":"var:preset|color|acid-lime"}},"backgroundColor":"acid-lime"} -->
		<hr class="wp-block-separator has-text-color has-acid-lime-background-color has-alpha-channel-opacity has-acid-lime-background-color has-background" style="margin-top:var(--wp--preset--spacing--30);margin-bottom:var(--wp--preset--spacing--30);color:var(--wp--preset--color--acid-lime);background-color:var(--wp--preset--color--acid-lime)"/>
		<!-- /wp:separator -->

		<!-- wp:post-content {"layout":{"type":"constrained"},"style":{"spacing":{"blockGap":"var:preset|spacing|40"}}} /-->

	</div>
	<!-- /wp:group -->

</main>
<!-- /wp:group -->

<!-- wp:template-part {"slug":"footer","tagName":"footer"} /-->

<style>
/* Remove Fusion Builder white backgrounds and borders */
#main-content .wp-block-post-content,
#main-content .wp-block-post-content > *,
#main-content .wp-block-post-content .fusion-builder-row,
#main-content .wp-block-post-content .fusion-column-wrapper,
#main-content .wp-block-post-content .fusion-column,
#main-content .wp-block-post-content .fusion-column-wrapper.fusion-column-has-shadow {
	background: transparent !important;
	background-color: transparent !important;
	border: none !important;
	outline: none !important;
	box-shadow: none !important;
	padding-left: 0 !important;
	padding-right: 0 !important;
}

/* Remove all borders and backgrounds from content area */
#main-content .wp-block-group {
	outline: none !important;
	box-shadow: none !important;
}

/* Preserve Fusion Builder grid and flex layouts */
#main-content .wp-block-post-content .fusion-gallery {
	display: flex !important;
	flex-wrap: wrap !important;
	gap: 10px !important;
	width: 100% !important;
	margin: 1rem 0 !important;
}

/* Fusion Gallery Images - default to auto width, will be overridden by column-specific rules */
#main-content .wp-block-post-content .fusion-gallery-image {
	flex: 0 0 auto !important;
	display: inline-block !important;
	box-sizing: border-box !important;
}

/* Fusion Gallery Images - ensure img tags are responsive */
#main-content .wp-block-post-content .fusion-gallery-image img {
	width: 100% !important;
	height: auto !important;
	display: block !important;
	object-fit: cover !important;
}

/* Fusion Gallery - 4 column layout (most common in posts) */
#main-content .wp-block-post-content .fusion-gallery[data-columns="4"] .fusion-gallery-image,
#main-content .wp-block-post-content .fusion-gallery.fusion-gallery-columns-4 .fusion-gallery-image {
	flex: 0 0 calc(25% - 7.5px) !important;
	width: calc(25% - 7.5px) !important;
	max-width: calc(25% - 7.5px) !important;
}

/* Fusion Gallery - 3 column layout */
#main-content .wp-block-post-content .fusion-gallery[data-columns="3"] .fusion-gallery-image,
#main-content .wp-block-post-content .fusion-gallery.fusion-gallery-columns-3 .fusion-gallery-image {
	flex: 0 0 calc(33.333% - 6.67px) !important;
	width: calc(33.333% - 6.67px) !important;
	max-width: calc(33.333% - 6.67px) !important;
}

/* Fusion Gallery - 2 column layout */
#main-content .wp-block-post-content .fusion-gallery[data-columns="2"] .fusion-gallery-image,
#main-content .wp-block-post-content .fusion-gallery.fusion-gallery-columns-2 .fusion-gallery-image {
	flex: 0 0 calc(50% - 5px) !important;
	width: calc(50% - 5px) !important;
	max-width: calc(50% - 5px) !important;
}

/* Fusion Gallery - 5 column layout */
#main-content .wp-block-post-content .fusion-gallery[data-columns="5"] .fusion-gallery-image,
#main-content .wp-block-post-content .fusion-gallery.fusion-gallery-columns-5 .fusion-gallery-image {
	flex: 0 0 calc(20% - 8px) !important;
	width: calc(20% - 8px) !important;
	max-width: calc(20% - 8px) !important;
}

/* Fusion Gallery - 6 column layout */
#main-content .wp-block-post-content .fusion-gallery[data-columns="6"] .fusion-gallery-image,
#main-content .wp-block-post-content .fusion-gallery.fusion-gallery-columns-6 .fusion-gallery-image {
	flex: 0 0 calc(16.666% - 8.33px) !important;
	width: calc(16.666% - 8.33px) !important;
	max-width: calc(16.666% - 8.33px) !important;
}

/* Fusion Gallery - Responsive: Mobile (< 768px) - force 2 columns */
@media (max-width: 767px) {
	#main-content .wp-block-post-content .fusion-gallery-image {
		flex: 0 0 calc(50% - 5px) !important;
		width: calc(50% - 5px) !important;
		max-width: calc(50% - 5px) !important;
	}
}

/* Fusion Gallery - Responsive: Very small mobile (< 480px) - force 1 column */
@media (max-width: 479px) {
	#main-content .wp-block-post-content .fusion-gallery-image {
		flex: 0 0 100% !important;
		width: 100% !important;
		max-width: 100% !important;
	}
}

/* Fix Fusion Builder responsive video embeds */
#main-content .wp-block-post-content .fusion-youtube,
#main-content .wp-block-post-content .video-shortcode {
	position: relative !important;
	padding-bottom: 56.25% !important;
	height: 0 !important;
	overflow: hidden !important;
	max-width: 100% !important;
}

#main-content .wp-block-post-content .fusion-youtube iframe,
#main-content .wp-block-post-content .video-shortcode iframe {
	position: absolute !important;
	top: 0 !important;
	left: 0 !important;
	width: 100% !important;
	height: 100% !important;
}

/* Fix Fusion Builder Lite YouTube Embed custom element */
#main-content .wp-block-post-content lite-youtube {
	display: block !important;
	position: relative !important;
	width: 100% !important;
	height: 100% !important;
	background-color: #000 !important;
	background-position: center center !important;
	background-size: cover !important;
	cursor: pointer !important;
}

/* Ensure lite-youtube fills the video-shortcode container */
#main-content .wp-block-post-content .video-shortcode lite-youtube {
	position: absolute !important;
	top: 0 !important;
	left: 0 !important;
	width: 100% !important;
	height: 100% !important;
}

/* Add play button to lite-youtube (if JS fails to add it) */
#main-content .wp-block-post-content lite-youtube::before {
	content: '' !important;
	display: block !important;
	position: absolute !important;
	top: 50% !important;
	left: 50% !important;
	width: 68px !important;
	height: 48px !important;
	transform: translate(-50%, -50%) !important;
	background-color: rgba(204, 255, 0, 0.9) !important;
	border-radius: 14% !important;
	transition: background-color 0.1s cubic-bezier(0, 0, 0.2, 1) !important;
	z-index: 1 !important;
}

/* Play button triangle */
#main-content .wp-block-post-content lite-youtube::after {
	content: '' !important;
	display: block !important;
	position: absolute !important;
	top: 50% !important;
	left: 50% !important;
	width: 0 !important;
	height: 0 !important;
	border-left: 20px solid #000 !important;
	border-top: 12px solid transparent !important;
	border-bottom: 12px solid transparent !important;
	transform: translate(-40%, -50%) !important;
	z-index: 2 !important;
}

/* Hover effect for play button */
#main-content .wp-block-post-content lite-youtube:hover::before {
	background-color: rgba(204, 255, 0, 1) !important;
}

/* Force background image to load for lite-youtube */
#main-content .wp-block-post-content lite-youtube[style*="background-image"] {
	background-size: cover !important;
	background-position: center !important;
	background-repeat: no-repeat !important;
}

/* Fallback: If lite-youtube has no background, show dark background */
#main-content .wp-block-post-content lite-youtube:not([style*="background-image"]) {
	background-color: #0a0a0a !important;
}
</style>

<script>
/**
 * Ensure lite-youtube custom elements load thumbnails
 * Fusion Builder's JS should handle this, but this is a fallback
 */
(function() {
	'use strict';

	function initLiteYouTube() {
		const liteVideos = document.querySelectorAll('lite-youtube');

		liteVideos.forEach(function(video) {
			const videoId = video.getAttribute('videoid');

			if (!videoId) {
				return;
			}

			// Check if background image is already set
			const hasBackground = video.style.backgroundImage && video.style.backgroundImage !== '';

			if (!hasBackground) {
				// Set high-res thumbnail as background
				const thumbnailUrl = 'https://i.ytimg.com/vi/' + videoId + '/maxresdefault.jpg';
				video.style.backgroundImage = 'url(' + thumbnailUrl + ')';
			}

			// Ensure the element is visible and clickable
			video.style.display = 'block';
			video.style.position = 'absolute';
			video.style.top = '0';
			video.style.left = '0';
			video.style.width = '100%';
			video.style.height = '100%';
			video.style.backgroundSize = 'cover';
			video.style.backgroundPosition = 'center';
			video.style.cursor = 'pointer';
		});
	}

	// Run when DOM is ready
	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', initLiteYouTube);
	} else {
		initLiteYouTube();
	}

	// Also run on window load to catch any late-loading elements
	window.addEventListener('load', initLiteYouTube);
})();

/**
 * Ensure Fusion Builder galleries display in correct grid layout
 * Detects column count and applies data attribute for CSS targeting
 */
(function() {
	'use strict';

	function initFusionGalleries() {
		const galleries = document.querySelectorAll('.fusion-gallery');

		galleries.forEach(function(gallery) {
			// Try to detect column count from various sources
			let columns = null;

			// Method 1: Check for data-columns attribute
			if (gallery.hasAttribute('data-columns')) {
				columns = gallery.getAttribute('data-columns');
			}

			// Method 2: Check for fusion-gallery-columns-X class
			if (!columns) {
				const classList = Array.from(gallery.classList);
				const columnClass = classList.find(function(cls) {
					return cls.match(/^fusion-gallery-columns-\d+$/);
				});
				if (columnClass) {
					columns = columnClass.replace('fusion-gallery-columns-', '');
				}
			}

			// Method 3: Check for columns-X class (alternative pattern)
			if (!columns) {
				const classList = Array.from(gallery.classList);
				const columnClass = classList.find(function(cls) {
					return cls.match(/^columns-\d+$/);
				});
				if (columnClass) {
					columns = columnClass.replace('columns-', '');
				}
			}

			// Method 4: Check inline style for grid-template-columns
			if (!columns && gallery.style.gridTemplateColumns) {
				const gridCols = gallery.style.gridTemplateColumns.split(' ').length;
				if (gridCols > 0) {
					columns = gridCols;
				}
			}

			// Method 5: Count child elements and guess (max 6 columns)
			if (!columns) {
				const images = gallery.querySelectorAll('.fusion-gallery-image');
				if (images.length >= 6) {
					columns = 4; // Default to 4 columns for large galleries
				} else if (images.length >= 4) {
					columns = 4;
				} else if (images.length === 3) {
					columns = 3;
				} else if (images.length === 2) {
					columns = 2;
				} else {
					columns = 1;
				}
			}

			// Apply data-columns attribute for CSS targeting
			if (columns) {
				gallery.setAttribute('data-columns', columns);

				// Also add class for better CSS specificity
				gallery.classList.add('fusion-gallery-columns-' + columns);
			}

			// Ensure gallery is using flex layout
			gallery.style.display = 'flex';
			gallery.style.flexWrap = 'wrap';
			gallery.style.width = '100%';
		});
	}

	// Run when DOM is ready
	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', initFusionGalleries);
	} else {
		initFusionGalleries();
	}

	// Also run on window load to catch any late-loading elements
	window.addEventListener('load', initFusionGalleries);
})();
</script>
