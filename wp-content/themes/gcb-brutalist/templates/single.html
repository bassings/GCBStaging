<!-- wp:template-part {"slug":"header"} /-->

<!-- wp:group {"tagName":"main","style":{"spacing":{"margin":{"top":"var:preset|spacing|50"},"padding":{"right":"var:preset|spacing|30","left":"var:preset|spacing|30"}}},"layout":{"type":"constrained"}} -->
<main id="main-content" class="wp-block-group" style="margin-top:var(--wp--preset--spacing--50);padding-right:var(--wp--preset--spacing--30);padding-left:var(--wp--preset--spacing--30)">

	<!-- wp:group {"style":{"spacing":{"padding":{"top":"3rem","right":"3rem","bottom":"3rem","left":"3rem"}},"border":{"width":"2px","style":"solid","color":"var:preset|color|brutal-border"}}} -->
	<div class="wp-block-group" style="border-color:var(--wp--preset--color--brutal-border);border-style:solid;border-width:2px;padding-top:3rem;padding-right:3rem;padding-bottom:3rem;padding-left:3rem">

		<!-- wp:post-title {"level":1,"style":{"typography":{"fontFamily":"var(--wp--preset--font-family--playfair)","fontSize":"3rem","lineHeight":"1.2"},"spacing":{"margin":{"bottom":"var:preset|spacing|30"}}}} /-->

		<!-- wp:post-date {"style":{"typography":{"fontFamily":"var(--wp--preset--font-family--mono)","fontSize":"0.875rem"},"color":{"text":"var:preset|color|brutal-grey"}},"className":"gcb-post-meta"} /-->

		<!-- wp:separator {"style":{"spacing":{"margin":{"top":"var:preset|spacing|30","bottom":"var:preset|spacing|30"}},"color":{"background":"var:preset|color|highlight"}},"backgroundColor":"highlight"} -->
		<hr class="wp-block-separator has-text-color has-highlight-background-color has-alpha-channel-opacity has-highlight-background-color has-background" style="margin-top:var(--wp--preset--spacing--30);margin-bottom:var(--wp--preset--spacing--30);color:var(--wp--preset--color--highlight);background-color:var(--wp--preset--color--highlight)"/>
		<!-- /wp:separator -->

		<!-- wp:post-content {"layout":{"type":"constrained"},"style":{"spacing":{"blockGap":"var:preset|spacing|30"}}} /-->

	</div>
	<!-- /wp:group -->

</main>
<!-- /wp:group -->

<!-- wp:group {"tagName":"section","style":{"spacing":{"padding":{"right":"var:preset|spacing|30","left":"var:preset|spacing|30","top":"0","bottom":"var:preset|spacing|50"}}},"layout":{"type":"constrained"}} -->
<section class="wp-block-group" style="padding-top:0;padding-right:var(--wp--preset--spacing--30);padding-bottom:var(--wp--preset--spacing--50);padding-left:var(--wp--preset--spacing--30)">
	<!-- wp:post-comments-form /-->
</section>
<!-- /wp:group -->

<!-- wp:template-part {"slug":"footer","tagName":"footer"} /-->

<style>
/* Disable WordPress aspect ratio ::before when video-shortcode handles it */
/* This prevents double aspect-ratio padding (WP ::before + video-shortcode padding-bottom) */
#main-content .wp-block-post-content .wp-block-embed__wrapper:has(.video-shortcode)::before {
	display: none !important;
}

/* Reduce excessive spacing between migrated Gutenberg blocks */
/* Override WordPress generated container classes with high specificity */
#main-content .wp-block-post-content[class*="is-layout"] > * + * {
	margin-block-start: 1rem !important;
}

#main-content .wp-block-post-content[class*="is-layout"] > *:first-child {
	margin-block-start: 0 !important;
}

/* Override all nested is-layout-flow margins */
#main-content .wp-block-post-content .is-layout-flow > * {
	margin-block-start: 0.5rem !important;
}

#main-content .wp-block-post-content .is-layout-flow > *:first-child {
	margin-block-start: 0 !important;
}

/* Override wp-container- generated classes that WordPress creates */
#main-content .wp-block-post-content [class*="wp-container-"] > * {
	margin-block-start: 0.5rem !important;
	margin-block-end: 0 !important;
}

#main-content .wp-block-post-content [class*="wp-container-"] > *:first-child {
	margin-block-start: 0 !important;
}

/* Remove gaps from wp-block-group containers */
#main-content .wp-block-post-content > .wp-block-group {
	margin-block-start: 1rem !important;
	margin-block-end: 0 !important;
}

#main-content .wp-block-post-content > .wp-block-group:first-child {
	margin-block-start: 0 !important;
}

#main-content .wp-block-post-content .wp-block-group > .wp-block-columns {
	margin-block-start: 0 !important;
	margin-block-end: 0 !important;
}

#main-content .wp-block-post-content .wp-block-columns {
	margin-bottom: 0 !important;
	margin-block-end: 0 !important;
	gap: 0.5rem !important;
}

/* Tighten internal column spacing */
#main-content .wp-block-post-content .wp-block-column > * + * {
	margin-block-start: 0.5rem !important;
}

/* Remove margins from embeds inside columns */
#main-content .wp-block-post-content .wp-block-column > .wp-block-embed {
	margin-block-start: 0 !important;
}

/* Fix double-nested video-shortcode padding issue */
#main-content .wp-block-post-content .video-shortcode .video-shortcode {
	padding-bottom: 0 !important;
	height: auto !important;
	position: static !important;
}

/* Remove Fusion Builder white backgrounds and borders */
#main-content .wp-block-post-content,
#main-content .wp-block-post-content > *,
#main-content .wp-block-post-content .fusion-builder-row,
#main-content .wp-block-post-content .fusion-column-wrapper,
#main-content .wp-block-post-content .fusion-column,
#main-content .wp-block-post-content .fusion-column-wrapper.fusion-column-has-shadow {
	background: transparent !important;
	background-color: transparent !important;
	border: none !important;
	outline: none !important;
	box-shadow: none !important;
	padding-left: 0 !important;
	padding-right: 0 !important;
}

/* Remove all borders and backgrounds from content area */
#main-content .wp-block-group {
	outline: none !important;
	box-shadow: none !important;
}

/* Brutalist Table Styling - Override all inline styles from legacy content */
#main-content .wp-block-post-content table {
	width: 100% !important;
	border-collapse: collapse !important;
	margin: 1rem 0 !important;
	background: transparent !important;
	background-color: transparent !important;
	font-family: var(--wp--preset--font-family--system-sans) !important;
	font-size: 0.875rem !important;
	line-height: 1.6 !important;
}

/* Table headers - Acid Lime accent */
#main-content .wp-block-post-content table thead,
#main-content .wp-block-post-content table thead tr,
#main-content .wp-block-post-content table thead th {
	background: var(--wp--preset--color--void-black) !important;
	background-color: var(--wp--preset--color--void-black) !important;
	color: var(--wp--preset--color--off-white) !important;
	border: 2px solid var(--wp--preset--color--highlight) !important;
	border-bottom: 2px solid var(--wp--preset--color--highlight) !important;
	font-weight: 700 !important;
	text-transform: uppercase !important;
	letter-spacing: 0.05em !important;
	padding: 12px 16px !important;
	text-align: left !important;
}

/* Table body cells - Void black background, off-white text */
#main-content .wp-block-post-content table tbody tr,
#main-content .wp-block-post-content table tbody td {
	background: var(--wp--preset--color--void-black) !important;
	background-color: var(--wp--preset--color--void-black) !important;
	color: var(--wp--preset--color--off-white) !important;
	border: 1px solid var(--wp--preset--color--brutal-border) !important;
	padding: 12px 16px !important;
	text-align: left !important;
}

/* Alternating row striping - Subtle contrast for readability */
#main-content .wp-block-post-content table tbody tr:nth-child(even) td {
	background: rgba(255, 255, 255, 0.02) !important;
	background-color: rgba(255, 255, 255, 0.02) !important;
}

/* Override any inline text color styles */
#main-content .wp-block-post-content table thead th,
#main-content .wp-block-post-content table thead th *,
#main-content .wp-block-post-content table tbody td,
#main-content .wp-block-post-content table tbody td * {
	color: var(--wp--preset--color--off-white) !important;
}

/* Table captions */
#main-content .wp-block-post-content table caption {
	color: var(--wp--preset--color--brutal-grey) !important;
	font-family: var(--wp--preset--font-family--system-sans) !important;
	font-size: 0.75rem !important;
	text-transform: uppercase !important;
	letter-spacing: 0.1em !important;
	padding: 8px 0 !important;
	text-align: left !important;
}

/* Ensure table doesn't overflow on mobile */
#main-content .wp-block-post-content table {
	display: block !important;
	overflow-x: auto !important;
	-webkit-overflow-scrolling: touch !important;
}

@media (max-width: 767px) {
	#main-content .wp-block-post-content table {
		font-size: 0.75rem !important;
	}

	#main-content .wp-block-post-content table thead th,
	#main-content .wp-block-post-content table tbody td {
		padding: 8px 12px !important;
	}
}

/* ⚠️ FUSION BUILDER GALLERY - NO CSS OVERRIDES ⚠️
 * Fusion Builder galleries use JavaScript for absolute positioning
 * ANY CSS targeting galleries breaks the JavaScript calculations
 * Solution: Let Fusion Builder handle galleries completely
 * Our theme CSS should NOT touch .fusion-gallery* or .awb-gallery* selectors
 */

/* Fix Fusion Builder responsive video embeds */
/* Only apply aspect ratio padding when NOT inside a WordPress embed that already handles it */
#main-content .wp-block-post-content .fusion-youtube:not(.wp-block-embed__wrapper .fusion-youtube),
#main-content .wp-block-post-content .video-shortcode:not(.wp-block-embed__wrapper .video-shortcode) {
	position: relative !important;
	padding-bottom: 56.25% !important;
	height: 0 !important;
	overflow: hidden !important;
	max-width: 100% !important;
}

/* Ensure video-shortcode handles aspect ratio properly inside embeds */
#main-content .wp-block-post-content .wp-block-embed__wrapper .video-shortcode {
	position: relative !important;
	padding-bottom: 56.25% !important;
	height: 0 !important;
	overflow: hidden !important;
}

/* General iframe positioning for standalone video-shortcode */
#main-content .wp-block-post-content .fusion-youtube iframe,
#main-content .wp-block-post-content .video-shortcode:not(.wp-block-embed__wrapper .video-shortcode) iframe {
	position: absolute !important;
	top: 0 !important;
	left: 0 !important;
	width: 100% !important;
	height: 100% !important;
}

/* When inside wp-block-embed, iframe inherits WordPress positioning */
#main-content .wp-block-post-content .wp-block-embed__wrapper .video-shortcode iframe,
#main-content .wp-block-post-content .wp-has-aspect-ratio .video-shortcode iframe {
	position: absolute !important;
	/* Positioning handled by WordPress .wp-embed-responsive rules */
}

/* Fix Fusion Builder Lite YouTube Embed custom element */
#main-content .wp-block-post-content lite-youtube {
	display: block !important;
	position: relative !important;
	width: 100% !important;
	height: 100% !important;
	background-color: var(--wp--preset--color--void-black) !important;
	background-position: center center !important;
	background-size: cover !important;
	cursor: pointer !important;
}

/* Ensure lite-youtube fills the video-shortcode container */
#main-content .wp-block-post-content .video-shortcode lite-youtube {
	position: absolute !important;
	top: 0 !important;
	left: 0 !important;
	width: 100% !important;
	height: 100% !important;
}

/* Add play button to lite-youtube (if JS fails to add it) */
#main-content .wp-block-post-content lite-youtube::before {
	content: '' !important;
	display: block !important;
	position: absolute !important;
	top: 50% !important;
	left: 50% !important;
	width: 68px !important;
	height: 48px !important;
	transform: translate(-50%, -50%) !important;
	background-color: var(--wp--preset--color--highlight) !important;
	border-radius: 14% !important;
	z-index: 1 !important;
}

/* Play button triangle */
#main-content .wp-block-post-content lite-youtube::after {
	content: '' !important;
	display: block !important;
	position: absolute !important;
	top: 50% !important;
	left: 50% !important;
	width: 0 !important;
	height: 0 !important;
	border-left: 20px solid var(--wp--preset--color--void-black) !important;
	border-top: 12px solid transparent !important;
	border-bottom: 12px solid transparent !important;
	transform: translate(-40%, -50%) !important;
	z-index: 2 !important;
}

/* Hover effect for play button */
#main-content .wp-block-post-content lite-youtube:hover::before {
	background-color: rgba(204, 255, 0, 1) !important;
}

/* Hide play button when video is activated */
#main-content .wp-block-post-content lite-youtube.lyt-activated::before,
#main-content .wp-block-post-content lite-youtube.lyt-activated::after,
#main-content .wp-block-post-content lite-youtube[data-activated]::before,
#main-content .wp-block-post-content lite-youtube[data-activated]::after {
	display: none !important;
}

/* Force background image to load for lite-youtube */
#main-content .wp-block-post-content lite-youtube[style*="background-image"] {
	background-size: cover !important;
	background-position: center !important;
	background-repeat: no-repeat !important;
}

/* Fallback: If lite-youtube has no background, show dark background */
#main-content .wp-block-post-content lite-youtube:not([style*="background-image"]) {
	background-color: var(--wp--preset--color--void-black) !important;
}
</style>

<script>
/**
 * Ensure lite-youtube custom elements load thumbnails
 * Fusion Builder's JS should handle this, but this is a fallback
 */
(function() {
	'use strict';

	function initLiteYouTube() {
		const liteVideos = document.querySelectorAll('lite-youtube');

		liteVideos.forEach(function(video) {
			const videoId = video.getAttribute('videoid');

			if (!videoId) {
				return;
			}

			// Check if background image is already set
			const hasBackground = video.style.backgroundImage && video.style.backgroundImage !== '';

			if (!hasBackground) {
				// Set high-res thumbnail as background
				const thumbnailUrl = 'https://i.ytimg.com/vi/' + videoId + '/maxresdefault.jpg';
				video.style.backgroundImage = 'url(' + thumbnailUrl + ')';
			}

			// Ensure the element is visible and clickable
			video.style.display = 'block';
			video.style.position = 'absolute';
			video.style.top = '0';
			video.style.left = '0';
			video.style.width = '100%';
			video.style.height = '100%';
			video.style.backgroundSize = 'cover';
			video.style.backgroundPosition = 'center';
			video.style.cursor = 'pointer';
		});
	}

	// Run when DOM is ready
	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', initLiteYouTube);
	} else {
		initLiteYouTube();
	}

	// Also run on window load to catch any late-loading elements
	window.addEventListener('load', initLiteYouTube);
})();

/**
 * Ensure Fusion Builder galleries display in correct grid layout
 * Detects column count and applies data attribute for CSS targeting
 */
(function() {
	'use strict';

	function initFusionGalleries() {
		// Try multiple selectors to find all gallery containers
		const selectors = [
			'.fusion-gallery',
			'.awb-image-gallery',
			'div[class*="fusion-gallery"]',
			'div[class*="awb-gallery"]'
		];

		let totalGalleries = 0;

		selectors.forEach(function(selector) {
			const galleries = document.querySelectorAll(selector);
			totalGalleries += galleries.length;

			galleries.forEach(function(gallery) {
				// Try to detect column count from various sources
				let columns = 4; // Default to 4 columns

				// Method 1: Check for data-columns attribute
				if (gallery.hasAttribute('data-columns')) {
					columns = parseInt(gallery.getAttribute('data-columns'), 10);
				}

				// Method 2: Check for fusion-gallery-columns-X class
				else {
					const classList = Array.from(gallery.classList);
					const columnClass = classList.find(function(cls) {
						return cls.match(/^fusion-gallery-columns-\d+$/) || cls.match(/^columns-\d+$/);
					});
					if (columnClass) {
						const match = columnClass.match(/\d+/);
						if (match) {
							columns = parseInt(match[0], 10);
						}
					}
				}

				// Method 3: Check inline style for grid-template-columns
				if (gallery.style.gridTemplateColumns) {
					const gridCols = gallery.style.gridTemplateColumns.split(' ').length;
					if (gridCols > 0) {
						columns = gridCols;
					}
				}

				// Method 4: Count child elements and guess
				const images = gallery.querySelectorAll('.fusion-gallery-image, .awb-gallery-image, img');
				if (images.length > 0 && columns === 4) {
					// Only override if we haven't detected columns yet
					if (images.length >= 12) {
						columns = 4;
					} else if (images.length >= 6) {
						columns = 3;
					} else if (images.length >= 4) {
						columns = 2;
					}
				}

				// Ensure columns is between 1 and 6
				columns = Math.max(1, Math.min(6, columns));

				// Apply data-columns attribute for CSS targeting
				gallery.setAttribute('data-columns', columns);

				// Add class for better CSS specificity
				gallery.classList.add('fusion-gallery-columns-' + columns);

				// Remove any conflicting classes
				for (let i = 1; i <= 6; i++) {
					if (i !== columns) {
						gallery.classList.remove('fusion-gallery-columns-' + i);
					}
				}

				// Force flex layout with inline styles (most aggressive)
				gallery.style.display = 'flex';
				gallery.style.flexWrap = 'wrap';
				gallery.style.width = '100%';
				gallery.style.gap = '10px';
				gallery.style.margin = '1rem 0';

				// Debug: Log to console (remove in production)
				if (window.console) {
					console.log('GCB Gallery initialized:', {
						selector: selector,
						columns: columns,
						images: images.length,
						classes: Array.from(gallery.classList).join(' ')
					});
				}
			});
		});

		// Debug: Log total galleries found
		if (window.console && totalGalleries > 0) {
			console.log('GCB Galleries: Found and initialized ' + totalGalleries + ' galleries');
		}
	}

	// Run when DOM is ready
	if (document.readyState === 'loading') {
		document.addEventListener('DOMContentLoaded', initFusionGalleries);
	} else {
		initFusionGalleries();
	}

	// Also run on window load to catch any late-loading elements
	window.addEventListener('load', initFusionGalleries);

	// Use MutationObserver to detect dynamically added galleries
	if (typeof MutationObserver !== 'undefined') {
		var observer = new MutationObserver(function(mutations) {
			var hasNewGallery = mutations.some(function(mutation) {
				return Array.from(mutation.addedNodes).some(function(node) {
					return node.nodeType === 1 && (
						node.classList && (
							node.classList.contains('fusion-gallery') ||
							node.classList.contains('awb-image-gallery')
						) ||
						node.querySelector && node.querySelector('.fusion-gallery, .awb-image-gallery')
					);
				});
			});
			if (hasNewGallery) {
				initFusionGalleries();
			}
		});
		observer.observe(document.body, { childList: true, subtree: true });
	}
})();
</script>
