<!-- wp:html -->
<?php
/**
 * Template Part: Category Children Grid
 * Displays child categories in a brutalist grid layout
 */

// Get current category
$current_category = get_queried_object();

if ( $current_category && isset( $current_category->term_id ) ) {
	// Get child categories
	$child_categories = get_terms( array(
		'taxonomy'   => 'category',
		'parent'     => $current_category->term_id,
		'hide_empty' => false,
		'orderby'    => 'name',
		'order'      => 'ASC',
	) );

	// Only render if children exist
	if ( ! empty( $child_categories ) && ! is_wp_error( $child_categories ) ) {
		?>
		<!-- Child Categories Grid -->
		<div class="category-children-grid" style="margin-bottom: 4rem;">

			<!-- Section Header -->
			<div style="border-bottom: 2px solid var(--wp--preset--color--acid-lime); padding-bottom: 1.5rem; margin-bottom: 2rem;">
				<h2 style="font-family: var(--wp--preset--font-family--playfair); font-size: 2rem; text-transform: uppercase; color: var(--wp--preset--color--off-white); margin: 0;">
					Browse by Brand
				</h2>
			</div>

			<!-- Brands Grid -->
			<div class="brands-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem;">
				<?php foreach ( $child_categories as $category ) : ?>
					<?php
					$category_link = get_term_link( $category );
					if ( is_wp_error( $category_link ) ) {
						continue;
					}
					?>
					<a href="<?php echo esc_url( $category_link ); ?>"
					   class="brand-card"
					   style="display: block; padding: 1.5rem 1rem; border: 2px solid var(--wp--preset--color--brutal-border); text-decoration: none; transition: none; background: transparent;">

						<div style="font-family: var(--wp--preset--font-family--mono); font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--wp--preset--color--off-white); margin-bottom: 0.5rem;">
							<?php echo esc_html( $category->name ); ?>
						</div>

						<div style="font-family: var(--wp--preset--font-family--mono); font-size: 0.75rem; color: var(--wp--preset--color--brutal-grey);">
							<?php echo esc_html( $category->count ); ?> <?php echo $category->count === 1 ? 'review' : 'reviews'; ?>
						</div>
					</a>
				<?php endforeach; ?>
			</div>

			<style>
				.brand-card:hover,
				.brand-card:focus {
					border-color: var(--wp--preset--color--acid-lime) !important;
					background-color: rgba(204, 255, 0, 0.05) !important;
					outline: none;
				}

				.brand-card:focus-visible {
					outline: 2px solid var(--wp--preset--color--acid-lime);
					outline-offset: 2px;
				}

				/* Responsive adjustments */
				@media (max-width: 768px) {
					.brands-grid {
						grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)) !important;
					}
				}

				@media (max-width: 480px) {
					.brands-grid {
						grid-template-columns: 1fr 1fr !important;
					}
				}
			</style>
		</div>
		<?php
	}
}
?>
<!-- /wp:html -->
